import{d as J,r as A,f as V,g as j,c as n,a as l,u,h as K,w as h,b as e,t as o,l as v,i as $,j as y,v as D,k as p,o as d,e as b,m as N,F as w,n as U,p as k,q as W,s as _}from"./app-Bz5YFX80.js";import{_ as c}from"./Icon.vue_vue_type_script_setup_true_lang-DRLq77En.js";import{_ as X}from"./AppLayout.vue_vue_type_script_setup_true_lang-Bk3RW129.js";import"./upload-DY5orng5.js";import"./trash-2-Bc4u38B2.js";import"./camera-CDRLtcGs.js";import"./check-YYHeAPsf.js";import"./image-B8JV3eqN.js";import"./sun-ZaxvDMs6.js";import"./user-plus-BrFMXlTI.js";import"./lazy-CSzc0j1S.js";const Y={class:"flex flex-1 flex-col gap-6 p-4 sm:p-6"},Z={class:"grid gap-4 sm:grid-cols-3"},ee={class:"flex items-start gap-4 rounded-xl border border-sidebar-border/60 bg-card p-4 shadow-sm dark:border-white/10"},te={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-primary/10 text-primary"},re={class:"min-w-0 flex-1"},se={class:"mt-1 text-2xl font-semibold tabular-nums text-foreground"},oe={class:"flex items-start gap-4 rounded-xl border border-sidebar-border/60 bg-card p-4 shadow-sm dark:border-white/10"},de={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-primary/10 text-primary"},ae={class:"min-w-0 flex-1"},ne={class:"mt-1 text-2xl font-semibold tabular-nums text-foreground"},ie={class:"flex items-start gap-4 rounded-xl border border-sidebar-border/60 bg-card p-4 shadow-sm dark:border-white/10"},le={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-primary/10 text-primary"},ue={class:"min-w-0 flex-1"},ce={class:"mt-1 text-2xl font-semibold tabular-nums text-foreground"},me={class:"flex flex-col gap-3"},xe={class:"grid gap-4 sm:grid-cols-2"},pe={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-primary/10 text-primary"},be={class:"min-w-0"},fe={class:"text-xs text-muted-foreground"},he={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-primary/10 text-primary"},ge={class:"flex flex-col gap-3"},ve={class:"rounded-xl border border-sidebar-border/60 bg-card p-3 shadow-sm dark:border-white/10"},ye={class:"min-w-[140px] flex-1"},we={class:"flex shrink-0 gap-2"},ke={class:"overflow-hidden rounded-xl border border-sidebar-border/60 bg-card shadow-sm dark:border-white/10"},_e={class:"max-h-[420px] overflow-auto"},qe={class:"w-full min-w-[800px] text-xs"},Se={class:"sticky top-0 z-10 border-b border-sidebar-border/60 bg-muted/50 text-[11px] uppercase tracking-wide text-muted-foreground dark:border-white/10 dark:bg-white/5"},Te={class:"px-3 py-2.5 text-left font-semibold"},Ce={class:"px-3 py-2.5 text-left font-semibold"},De={class:"divide-y divide-sidebar-border/60 text-foreground dark:divide-white/10"},Ne={class:"px-3 py-2 font-medium"},Qe={key:1},Ae=["title"],Ue=["title"],Fe={class:"px-3 py-2"},Le={class:"px-3 py-2"},Re=["title"],Be={class:"whitespace-nowrap px-3 py-2 text-muted-foreground"},Ve={key:0},je={key:0,class:"border-t border-sidebar-border/60 px-3 py-2 text-center dark:border-white/10"},$e={class:"flex flex-col gap-3"},Me={class:"flex flex-wrap items-center justify-between gap-2"},Oe={class:"flex flex-col gap-3 rounded-xl border border-sidebar-border/60 bg-card p-4 shadow-sm dark:border-white/10"},Pe={class:"min-w-[200px] flex-1"},He={class:"flex flex-wrap items-end gap-3 rounded-lg border border-sidebar-border/40 bg-muted/30 p-3 dark:border-white/10 dark:bg-white/5"},Ee={class:"min-w-[120px]"},Ge={class:"min-w-[120px]"},ze=["href"],Ie={class:"overflow-x-auto"},Je={class:"w-full min-w-[720px] text-xs"},Ke={class:"divide-y divide-sidebar-border/60 text-foreground dark:divide-white/10"},We={class:"px-3 py-2 font-medium"},Xe={key:1},Ye=["title"],Ze={class:"max-w-[120px] truncate px-3 py-2"},et={class:"px-3 py-2"},tt={class:"px-3 py-2"},rt={class:"whitespace-nowrap px-3 py-2 text-muted-foreground"},st={key:0},ot={key:0,class:"flex flex-wrap items-center justify-center gap-2 pt-2"},dt=["innerHTML","onClick"],at=["innerHTML"],Q="inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] font-medium leading-4",vt=J({__name:"AdminDashboard",props:{totalGenerated:{},activeQueueTotal:{},stats:{},activeQueue:{},archive:{},filters:{},sort:{},archiveSearch:{},archivePanelOpen:{type:Boolean}},setup(a){const x=a,M=[{title:"Admin Dashboard",href:"/admin/dashboard"}],q=A(x.archivePanelOpen??!1),f=V({control_ticket_number:x.filters.control_ticket_number??""}),g=V({archive_search:x.archiveSearch??""}),S=A(""),T=A(""),O=j(()=>{const s=new URLSearchParams;g.archive_search&&s.set("archive_search",g.archive_search),S.value&&s.set("date_from",S.value),T.value&&s.set("date_to",T.value);const t=s.toString();return`/admin/dashboard/archive-export${t?`?${t}`:""}`}),P=j(()=>!!f.control_ticket_number);function C(s={}){const t={};return f.control_ticket_number&&(t.control_ticket_number=f.control_ticket_number),x.archiveSearch&&(t.archive_search=x.archiveSearch),{...t,...s}}function H(){_.get("/admin/dashboard",C(),{preserveState:!0,only:["activeQueue","activeQueueTotal","stats","filters","sort","archive","archiveSearch"]})}function E(){f.reset(),_.get("/admin/dashboard",C(),{preserveState:!0,only:["activeQueue","activeQueueTotal","stats","filters","sort","archive","archiveSearch"]})}function F(s){const t=x.sort.by===s&&x.sort.dir==="asc"?"desc":"asc";_.get("/admin/dashboard",C({sort_by:s,sort_dir:t}),{preserveState:!0,only:["activeQueue","activeQueueTotal","stats","filters","sort","archive","archiveSearch"]})}function G(){_.get("/admin/dashboard",C({archive_search:g.archive_search||void 0}),{preserveState:!0,only:["archive","archiveSearch"]})}function z(s){s&&_.visit(s)}const m={emerald:"border-emerald-500/30 bg-emerald-500/10 text-emerald-700 dark:text-emerald-300",blue:"border-blue-500/30 bg-blue-500/10 text-blue-700 dark:text-blue-300",amber:"border-amber-500/30 bg-amber-500/10 text-amber-700 dark:text-amber-300",rose:"border-rose-500/30 bg-rose-500/10 text-rose-700 dark:text-rose-300",slate:"border-slate-500/20 bg-slate-500/10 text-slate-600 dark:text-slate-300"};function L(s){const t=(s??"").toLowerCase();return t.includes("completed")||t.includes("closed")?m.emerald:t.includes("ongoing")||t.includes("assigned")?m.blue:t.includes("pending")||t.includes("review")?m.amber:m.slate}function R(s){const t=(s??"").toLowerCase();return t.includes("simple")?m.emerald:t.includes("average")||t.includes("moderate")?m.amber:t.includes("complex")||t.includes("urgent")?m.rose:m.slate}function B(s){if(!s)return"—";const t=new Date(s);return Number.isNaN(t.getTime())?s:new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",year:"numeric"}).format(t)}function i(s,t="—"){return s&&s.trim().length>0?s:t}return(s,t)=>(d(),n(w,null,[l(u(K),{title:"Admin Dashboard"}),l(X,{breadcrumbs:M},{default:h(()=>[e("div",Y,[e("div",Z,[e("div",ee,[e("div",te,[l(c,{name:"clipboardList",class:"h-5 w-5"})]),e("div",re,[t[7]||(t[7]=e("p",{class:"text-[11px] font-medium uppercase tracking-wider text-muted-foreground"}," Active in queue ",-1)),e("p",se,o(a.stats.activeInQueue),1),t[8]||(t[8]=e("p",{class:"mt-0.5 text-xs text-muted-foreground"}," Pending + Ongoing ",-1))])]),e("div",oe,[e("div",de,[l(c,{name:"userCheck",class:"h-5 w-5"})]),e("div",ae,[t[9]||(t[9]=e("p",{class:"text-[11px] font-medium uppercase tracking-wider text-muted-foreground"}," Assigned to me ",-1)),e("p",ne,o(a.stats.assignedToMe),1),t[10]||(t[10]=e("p",{class:"mt-0.5 text-xs text-muted-foreground"}," Requests assigned to you ",-1))])]),e("div",ie,[e("div",le,[l(c,{name:"layers",class:"h-5 w-5"})]),e("div",ue,[t[11]||(t[11]=e("p",{class:"text-[11px] font-medium uppercase tracking-wider text-muted-foreground"}," Total received ",-1)),e("p",ce,o(a.stats.totalReceived),1),t[12]||(t[12]=e("p",{class:"mt-0.5 text-xs text-muted-foreground"}," All requests received ",-1))])])]),e("div",me,[t[15]||(t[15]=e("h2",{class:"text-sm font-semibold text-foreground"}," Quick actions ",-1)),e("div",xe,[l(u(v),{href:"/admin/qr-generator",class:"flex items-center gap-3 rounded-xl border border-sidebar-border/60 bg-card p-4 shadow-sm dark:border-white/10"},{default:h(()=>[e("div",pe,[l(c,{name:"qrcode",class:"h-5 w-5"})]),e("div",be,[t[13]||(t[13]=e("p",{class:"text-sm font-medium text-foreground"}," QR Generator ",-1)),e("p",fe,o(a.totalGenerated)+" codes generated ",1)])]),_:1}),l(u(v),{href:"/admin/enrollments/create",class:"flex items-center gap-3 rounded-xl border border-sidebar-border/60 bg-card p-4 shadow-sm dark:border-white/10"},{default:h(()=>[e("div",he,[l(c,{name:"clipboardList",class:"h-5 w-5"})]),t[14]||(t[14]=e("div",{class:"min-w-0"},[e("p",{class:"text-sm font-medium text-foreground"}," Enroll ticket "),e("p",{class:"text-xs text-muted-foreground"}," Add new enrollment ")],-1))]),_:1})])]),e("div",ge,[t[26]||(t[26]=e("h2",{class:"text-sm font-semibold text-foreground"}," Requests Queue ",-1)),t[27]||(t[27]=e("p",{class:"text-xs text-muted-foreground"}," Latest 15 active requests (excluding Completed). Sort by name or control ticket, and filter below. ",-1)),e("div",ve,[e("form",{class:"flex flex-wrap items-end gap-3",onSubmit:$(H,["prevent"])},[e("div",ye,[t[16]||(t[16]=e("label",{class:"mb-1 block text-[11px] font-medium uppercase text-muted-foreground"}," Control ticket ",-1)),y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>u(f).control_ticket_number=r),type:"text",class:"w-full rounded-md border border-sidebar-border/60 bg-background px-2.5 py-1.5 text-xs text-foreground dark:border-white/10",placeholder:"e.g. CTRL-001"},null,512),[[D,u(f).control_ticket_number]])]),e("div",we,[t[17]||(t[17]=e("button",{type:"submit",class:"rounded-md bg-primary px-3 py-1.5 text-xs font-medium text-primary-foreground hover:opacity-90"}," Apply ",-1)),P.value?(d(),n("button",{key:0,type:"button",class:"rounded-md border border-sidebar-border/60 px-3 py-1.5 text-xs font-medium text-foreground dark:border-white/10",onClick:E}," Clear ")):p("",!0)])],32)]),e("div",ke,[e("div",_e,[e("table",qe,[e("thead",Se,[e("tr",null,[e("th",Te,[e("button",{type:"button",class:"flex items-center gap-1 hover:text-foreground",onClick:t[1]||(t[1]=r=>F("control_ticket_number"))},[t[18]||(t[18]=b(" Control ticket ",-1)),a.sort.by==="control_ticket_number"?(d(),N(c,{key:0,name:a.sort.dir==="asc"?"chevronUp":"chevronDown",class:"h-3.5 w-3.5"},null,8,["name"])):p("",!0)])]),e("th",Ce,[e("button",{type:"button",class:"flex items-center gap-1 hover:text-foreground",onClick:t[2]||(t[2]=r=>F("requester_name"))},[t[19]||(t[19]=b(" Requester ",-1)),a.sort.by==="requester_name"?(d(),N(c,{key:0,name:a.sort.dir==="asc"?"chevronUp":"chevronDown",class:"h-3.5 w-3.5"},null,8,["name"])):p("",!0)])]),t[20]||(t[20]=e("th",{class:"px-3 py-2.5 text-left font-semibold"}," Office ",-1)),t[21]||(t[21]=e("th",{class:"px-3 py-2.5 text-left font-semibold"}," Category ",-1)),t[22]||(t[22]=e("th",{class:"px-3 py-2.5 text-left font-semibold"}," Status ",-1)),t[23]||(t[23]=e("th",{class:"max-w-[160px] px-3 py-2.5 text-left font-semibold"}," Remarks ",-1)),t[24]||(t[24]=e("th",{class:"px-3 py-2.5 text-left font-semibold"}," Date filed ",-1))])]),e("tbody",De,[(d(!0),n(w,null,U(a.activeQueue,r=>(d(),n("tr",{key:r.id,class:"hover:bg-muted/30 dark:hover:bg-white/5"},[e("td",Ne,[r.showUrl?(d(),N(u(v),{key:0,href:r.showUrl,class:"text-primary hover:underline"},{default:h(()=>[b(o(r.controlTicketNumber),1)]),_:2},1032,["href"])):(d(),n("span",Qe,o(r.controlTicketNumber),1))]),e("td",{class:"max-w-[140px] truncate px-3 py-2",title:i(r.requesterName)},o(i(r.requesterName)),9,Ae),e("td",{class:"max-w-[120px] truncate px-3 py-2",title:i(r.office)},o(i(r.office)),9,Ue),e("td",Fe,[e("span",{class:k([Q,R(r.category)])},o(i(r.category,"—")),3)]),e("td",Le,[e("span",{class:k([Q,L(r.status)])},o(i(r.status,"—")),3)]),e("td",{class:"max-w-[160px] truncate px-3 py-2 text-muted-foreground",title:i(r.remarks)},o(i(r.remarks,"—")),9,Re),e("td",Be,o(B(r.dateFiled)),1)]))),128)),a.activeQueue.length===0?(d(),n("tr",Ve,[...t[25]||(t[25]=[e("td",{colspan:"7",class:"px-4 py-8 text-center text-xs text-muted-foreground"}," No active requests in the queue. ",-1)])])):p("",!0)])])]),a.activeQueueTotal>15?(d(),n("div",je,[l(u(v),{href:"/requests",class:"text-xs font-medium text-primary hover:underline"},{default:h(()=>[b(" View all "+o(a.activeQueueTotal)+" active requests → ",1)]),_:1})])):p("",!0)])]),e("div",$e,[e("div",Me,[e("button",{type:"button",class:"flex items-center gap-2 text-sm font-semibold text-foreground hover:underline",onClick:t[3]||(t[3]=r=>q.value=!q.value)},[l(c,{name:q.value?"chevronDown":"chevronRight",class:"h-4 w-4"},null,8,["name"]),t[28]||(t[28]=b(" Archived Requests ",-1))])]),y(e("div",Oe,[e("form",{class:"flex flex-wrap items-end gap-3",onSubmit:$(G,["prevent"])},[e("div",Pe,[t[29]||(t[29]=e("label",{class:"mb-1 block text-[11px] font-medium uppercase text-muted-foreground"}," Search archive ",-1)),y(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>u(g).archive_search=r),type:"text",class:"w-full rounded-md border border-sidebar-border/60 bg-background px-2.5 py-1.5 text-xs text-foreground dark:border-white/10",placeholder:"Control ticket or requester name"},null,512),[[D,u(g).archive_search]])]),t[30]||(t[30]=e("button",{type:"submit",class:"rounded-md bg-primary px-3 py-1.5 text-xs font-medium text-primary-foreground hover:opacity-90"}," Search ",-1))],32),e("div",He,[t[34]||(t[34]=e("p",{class:"w-full text-[11px] font-medium uppercase text-muted-foreground"}," Download report ",-1)),e("div",Ee,[t[31]||(t[31]=e("label",{class:"mb-1 block text-[11px] font-medium uppercase text-muted-foreground"}," Date from ",-1)),y(e("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>S.value=r),type:"date",class:"w-full rounded-md border border-sidebar-border/60 bg-background px-2.5 py-1.5 text-xs text-foreground dark:border-white/10"},null,512),[[D,S.value]])]),e("div",Ge,[t[32]||(t[32]=e("label",{class:"mb-1 block text-[11px] font-medium uppercase text-muted-foreground"}," Date to ",-1)),y(e("input",{"onUpdate:modelValue":t[6]||(t[6]=r=>T.value=r),type:"date",class:"w-full rounded-md border border-sidebar-border/60 bg-background px-2.5 py-1.5 text-xs text-foreground dark:border-white/10"},null,512),[[D,T.value]])]),e("a",{href:O.value,class:"inline-flex items-center gap-2 rounded-md border border-sidebar-border/60 bg-card px-3 py-1.5 text-xs font-medium text-foreground hover:bg-muted/50 dark:border-white/10"},[l(c,{name:"download",class:"h-4 w-4"}),t[33]||(t[33]=b(" Download Report ",-1))],8,ze),t[35]||(t[35]=e("p",{class:"w-full text-[11px] text-muted-foreground"}," Exports completed requests. Optional date range (max 365 days). Current search filter is applied. ",-1))]),e("div",Ie,[e("table",Je,[t[37]||(t[37]=e("thead",{class:"border-b border-sidebar-border/60 bg-muted/50 text-[11px] uppercase tracking-wide text-muted-foreground dark:border-white/10 dark:bg-white/5"},[e("tr",null,[e("th",{class:"px-3 py-2.5 text-left font-semibold"}," Control ticket "),e("th",{class:"px-3 py-2.5 text-left font-semibold"}," Requester "),e("th",{class:"px-3 py-2.5 text-left font-semibold"}," Office "),e("th",{class:"px-3 py-2.5 text-left font-semibold"}," Category "),e("th",{class:"px-3 py-2.5 text-left font-semibold"}," Status "),e("th",{class:"px-3 py-2.5 text-left font-semibold"}," Date filed ")])],-1)),e("tbody",Ke,[(d(!0),n(w,null,U(a.archive.data,r=>(d(),n("tr",{key:r.id,class:"hover:bg-muted/30 dark:hover:bg-white/5"},[e("td",We,[r.showUrl?(d(),N(u(v),{key:0,href:r.showUrl,class:"text-primary hover:underline"},{default:h(()=>[b(o(r.controlTicketNumber),1)]),_:2},1032,["href"])):(d(),n("span",Xe,o(r.controlTicketNumber),1))]),e("td",{class:"max-w-[140px] truncate px-3 py-2",title:i(r.requesterName)},o(i(r.requesterName)),9,Ye),e("td",Ze,o(i(r.office)),1),e("td",et,[e("span",{class:k([Q,R(r.category)])},o(i(r.category,"—")),3)]),e("td",tt,[e("span",{class:k([Q,L(r.status)])},o(i(r.status,"—")),3)]),e("td",rt,o(B(r.dateFiled)),1)]))),128)),a.archive.data.length===0?(d(),n("tr",st,[...t[36]||(t[36]=[e("td",{colspan:"6",class:"px-4 py-8 text-center text-xs text-muted-foreground"}," No archived requests. ",-1)])])):p("",!0)])])]),a.archive.last_page>1?(d(),n("div",ot,[(d(!0),n(w,null,U(a.archive.links,(r,I)=>(d(),n(w,{key:I},[r.url?(d(),n("button",{key:0,type:"button",class:k(["rounded border border-sidebar-border/60 px-2 py-1 text-xs text-foreground hover:bg-muted/50 dark:border-white/10",{"bg-primary text-primary-foreground":r.active}]),innerHTML:r.label,onClick:nt=>z(r.url)},null,10,dt)):(d(),n("span",{key:1,class:"px-2 py-1 text-xs text-muted-foreground",innerHTML:r.label},null,8,at))],64))),128))])):p("",!0)],512),[[W,q.value]])])])]),_:1})],64))}});export{vt as default};
