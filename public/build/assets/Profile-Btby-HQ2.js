import{d as w,m as D,u as s,a9 as L,w as r,ab as O,o as m,c as _,a as t,b as a,e as d,aj as I,C as B,g as f,f as F,s as P,h as R,k as V,t as M,i as N,T as G,j as q,q as z}from"./app-Cclhwly9.js";import{_ as b}from"./HeadingSmall.vue_vue_type_script_setup_true_lang-Cwxr9xBi.js";import{y as W,a as p,v as J,z as X,X as Y,_ as Z}from"./AppLayout.vue_vue_type_script_setup_true_lang-pl8mKwt0.js";import{a as H,b as K,c as Q,d as ee,_ as te}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BnGLZ_H5.js";import{_ as se}from"./DialogClose.vue_vue_type_script_setup_true_lang-D19aUzuk.js";import{_ as ae}from"./DialogFooter.vue_vue_type_script_setup_true_lang-Bm3vqXWY.js";import{b as x,_ as $,a as C}from"./Label.vue_vue_type_script_setup_true_lang-DX8dCyZw.js";import{_ as re}from"./Layout.vue_vue_type_script_setup_true_lang-DmRXh7md.js";import{C as le}from"./camera-BRWBg8pt.js";import{C as ie}from"./check-vFsMzDpT.js";import"./lazy-CSzc0j1S.js";const oe=w({__name:"DialogTrigger",props:{asChild:{type:Boolean},as:{}},setup(g){const v=g;return(l,o)=>(m(),D(s(W),L({"data-slot":"dialog-trigger"},v),{default:r(()=>[O(l.$slots,"default")]),_:3},16))}}),ne={class:"space-y-6"},de={class:"space-y-4 rounded-lg border border-red-100 bg-red-50 p-4 dark:border-red-200/10 dark:bg-red-700/10"},ue=w({__name:"DeleteUser",setup(g){return(v,l)=>(m(),_("div",ne,[t(b,{title:"Delete account",description:"Delete your account and all of its resources"}),a("div",de,[l[5]||(l[5]=a("div",{class:"relative space-y-0.5 text-red-600 dark:text-red-100"},[a("p",{class:"font-medium"},"Warning"),a("p",{class:"text-sm"}," Please proceed with caution, this cannot be undone. ")],-1)),t(s(te),null,{default:r(()=>[t(s(oe),{"as-child":""},{default:r(()=>[t(s(p),{variant:"destructive","data-test":"delete-user-button"},{default:r(()=>[...l[0]||(l[0]=[d("Delete account",-1)])]),_:1})]),_:1}),t(s(H),null,{default:r(()=>[t(s(I),{action:"/settings/profile",method:"delete","reset-on-success":"",options:{preserveScroll:!0},class:"space-y-6"},{default:r(({processing:o,reset:h,clearErrors:u})=>[t(s(K),{class:"space-y-3"},{default:r(()=>[t(s(Q),null,{default:r(()=>[...l[1]||(l[1]=[d("Are you sure you want to delete your account?",-1)])]),_:1}),t(s(ee),null,{default:r(()=>[...l[2]||(l[2]=[d(" Once your account is deleted, all of its resources and data will also be permanently deleted. Please confirm you would like to permanently delete your account. ",-1)])]),_:1})]),_:1}),t(s(ae),{class:"gap-2"},{default:r(()=>[t(s(se),{"as-child":""},{default:r(()=>[t(s(p),{variant:"secondary",onClick:()=>{u(),h()}},{default:r(()=>[...l[3]||(l[3]=[d(" Cancel ",-1)])]),_:1},8,["onClick"])]),_:2},1024),t(s(p),{type:"submit",variant:"destructive",disabled:o,"data-test":"confirm-delete-user-button"},{default:r(()=>[...l[4]||(l[4]=[d(" Delete account ",-1)])]),_:1},8,["disabled"])]),_:2},1024)]),_:1})]),_:1})]),_:1})])]))}}),ce={class:"flex flex-col space-y-8"},fe={class:"relative z-10 flex flex-col space-y-6 isolate","aria-label":"Profile picture section"},pe=["data-current-avatar","data-csrf-token","data-initials"],me={class:"group relative flex shrink-0 select-none rounded-full"},ve={class:"relative flex h-36 w-36 cursor-pointer items-center justify-center overflow-hidden rounded-full border-4 border-white shadow-lg transition focus-visible:ring-2 focus-visible:ring-[#2563eb] focus-visible:ring-offset-2 focus-visible:ring-offset-background dark:border-slate-800/80 dark:focus-visible:ring-[#93c5fd] dark:focus-visible:ring-offset-[#0b1b3a] sm:h-40 sm:w-40","x-on:click.prevent":"choose","x-on:drop":"onDrop","x-on:dragover":"onDragOver","x-on:dragleave":"onDragLeave","x-bind:class":"dragOver ? 'ring-4 ring-[#2563eb]/60 ring-offset-2 ring-offset-background dark:ring-[#93c5fd]/60 dark:ring-offset-[#0b1b3a]' : ''"},ge=["alt"],he={class:"absolute inset-0 flex flex-col items-center justify-center rounded-full bg-black/50 opacity-0 transition-opacity duration-200 group-hover:opacity-100 group-focus-within:opacity-100","aria-hidden":"true"},xe={"x-show":"file",class:"flex flex-wrap items-center gap-2","x-cloak":""},_e={key:0,class:"text-sm font-medium text-emerald-600 dark:text-emerald-400",role:"status"},be={class:"flex flex-col space-y-6"},we={class:"grid gap-2"},ke={class:"grid gap-2"},ye={class:"flex items-center gap-4"},Ue={class:"text-sm text-neutral-600"},S="image/jpeg,image/jpg,image/png,image/webp",Pe=50*1024*1024,$e="profile-avatar-input",Ce="/settings/profile/avatar",Re=w({__name:"Profile",props:{status:{},errors:{default:()=>({})},auth:{}},setup(g){const v=[{title:"Profile settings",href:J().url}],l=B(),o=f(()=>l.props.auth?.user),{getInitials:h}=X(),u=F({name:o.value?.name||""}),T=S.split(",").map(n=>n.trim()),k=f(()=>o.value?.avatar_url??(o.value?.avatar&&o.value.avatar!==""?o.value.avatar:null)),A=f(()=>l.props.csrf_token??""),y=f(()=>l.props.status),j=f(()=>l.props.errors?.avatar),E=f(()=>o.value?h(o.value.name):"?");return window.profileAvatarUploader=n=>{const e=n.currentAvatar;return{file:null,previewUrl:n.currentAvatar,error:"",success:"",uploading:!1,progress:0,dragOver:!1,initials:n.initials||"?",cameraLabel(){return this.file?"Choose different photo":"Change Photo"},choose(){this.$refs.fileInput?.click()},onDragOver(i){i.preventDefault(),this.dragOver=!0},onDragLeave(){this.dragOver=!1},onDrop(i){i.preventDefault(),this.dragOver=!1;const c=i.dataTransfer?.files?.[0];c&&this.setFile(c)},onChange(i){const c=i.target,U=c.files?.[0];U&&this.setFile(U),c.value=""},clearMessages(){this.error="",this.success=""},clearSelection(){this.previewUrl&&this.previewUrl!==e&&URL.revokeObjectURL(this.previewUrl),this.previewUrl=e,this.file=null,this.progress=0,this.clearMessages()},setFile(i){if(this.clearMessages(),!T.includes(i.type)){this.error="Please choose a JPG, PNG, or WEBP image.";return}if(i.size>Pe){this.error="Image must be under 50 MB.";return}this.previewUrl&&this.previewUrl!==e&&URL.revokeObjectURL(this.previewUrl),this.previewUrl=URL.createObjectURL(i),this.file=i},save(){if(!this.file){this.error="Please choose a photo first.";return}if(!n.csrfToken){this.error="Session expired. Please refresh and try again.";return}this.uploading=!0,this.error="",this.success="",this.progress=0;const i=new FormData;i.append("_token",n.csrfToken),i.append("avatar",this.file),P.post(n.uploadUrl,i,{forceFormData:!0,preserveState:!1,onProgress:c=>{this.progress=c?.percent??0},onSuccess:()=>{this.success="Profile photo updated.",this.file=null,this.progress=100,this.previewUrl&&this.previewUrl!==e&&URL.revokeObjectURL(this.previewUrl),this.previewUrl=e},onError:c=>{this.error=c?.avatar||"Failed to update photo."},onFinish:()=>{this.uploading=!1,this.error||P.reload({preserveState:!1})}})}}},(n,e)=>(m(),D(Z,{breadcrumbs:v},{default:r(()=>[t(s(R),{title:"Profile settings"}),e[13]||(e[13]=a("h1",{class:"sr-only"},"Profile Settings",-1)),t(re,null,{default:r(()=>[a("div",ce,[a("section",fe,[t(b,{title:"Profile picture",description:"Click your photo to change it. JPG, PNG or WEBP, up to 50 MB. Shown across the app."}),(m(),_("div",{key:(k.value??"")+"_"+(o.value?.id??""),"x-data":`profileAvatarUploader({
                            currentAvatar: $el.dataset.currentAvatar || null,
                            csrfToken: $el.dataset.csrfToken || '',
                            uploadUrl: $el.dataset.uploadUrl || avatarUploadUrl,
                            initials: $el.dataset.initials || userInitials,
                        })`,"data-current-avatar":k.value??"","data-csrf-token":A.value,"data-upload-url":Ce,"data-initials":E.value,class:"flex flex-col items-center gap-6 sm:items-start"},[a("input",{id:$e,"x-ref":"fileInput",type:"file",accept:S,class:"sr-only","aria-label":"Choose profile photo","x-on:change":"onChange"}),a("div",me,[a("div",ve,[e[3]||(e[3]=a("span",{class:"sr-only"},"Change profile picture",-1)),a("img",{"x-show":"previewUrl","x-bind:src":"previewUrl",alt:o.value?.name??"Profile",class:"h-full w-full object-contain object-center"},null,8,ge),e[4]||(e[4]=a("div",{"x-show":"!previewUrl",class:"flex h-full w-full items-center justify-center bg-slate-200 text-4xl font-semibold text-slate-600 dark:bg-slate-700 dark:text-slate-300 sm:text-5xl"},[a("span",{"x-text":"initials"})],-1)),a("span",he,[t(s(le),{class:"h-10 w-10 text-white sm:h-12 sm:w-12"}),e[2]||(e[2]=a("span",{class:"mt-1.5 text-sm font-medium text-white","x-text":"cameraLabel()"},null,-1))])])]),a("div",xe,[t(s(p),{type:"button",disabled:n.uploading,"data-test":"save-avatar-button",class:"gap-2","x-on:click":"save"},{default:r(()=>[t(s(ie),{class:"h-4 w-4","aria-hidden":"true"}),e[5]||(e[5]=a("span",{"x-text":"uploading ? 'Saving…' : 'Save'"},null,-1))]),_:1},8,["disabled"]),t(s(p),{type:"button",variant:"outline",disabled:n.uploading,class:"gap-2","x-on:click":"clearSelection"},{default:r(()=>[t(s(Y),{class:"h-4 w-4","aria-hidden":"true"}),e[6]||(e[6]=d(" Cancel ",-1))]),_:1},8,["disabled"]),e[7]||(e[7]=a("div",{"x-show":"uploading",class:"text-sm text-muted-foreground","x-cloak":""},[d(" Uploading… "),a("span",{"x-text":"`${Math.round(progress ?? 0)}%`"})],-1))]),y.value?(m(),_("p",_e,M(y.value),1)):V("",!0),e[8]||(e[8]=a("p",{"x-show":"success",class:"text-sm font-medium text-emerald-600 dark:text-emerald-400","x-text":"success",role:"status","x-cloak":""},null,-1)),e[9]||(e[9]=a("p",{"x-show":"error",class:"text-sm font-medium text-rose-600 dark:text-rose-400","x-text":"error",role:"status","x-cloak":""},null,-1)),t(x,{message:j.value,class:"text-center sm:text-left"},null,8,["message"])],8,pe))]),a("section",be,[t(b,{title:"Profile information",description:"Update your name and email address"}),a("form",{onSubmit:e[1]||(e[1]=N(i=>s(u).patch("/settings/profile"),["prevent"])),class:"space-y-6"},[a("div",we,[t(s($),{for:"name"},{default:r(()=>[...e[10]||(e[10]=[d("Name",-1)])]),_:1}),t(s(C),{id:"name",class:"mt-1 block w-full",modelValue:s(u).name,"onUpdate:modelValue":e[0]||(e[0]=i=>s(u).name=i),name:"name",required:"",autocomplete:"name",placeholder:"Full name"},null,8,["modelValue"]),t(x,{class:"mt-2",message:s(u).errors.name},null,8,["message"])]),a("div",ke,[t(s($),{for:"email"},{default:r(()=>[...e[11]||(e[11]=[d("Email address",-1)])]),_:1}),t(s(C),{id:"email",type:"email",class:"mt-1 block w-full",name:"email","default-value":o.value?.email,required:"",autocomplete:"username",placeholder:"Email address",disabled:""},null,8,["default-value"]),t(x,{class:"mt-2",message:s(u).errors.email},null,8,["message"])]),a("div",ye,[t(s(p),{type:"submit",disabled:s(u).processing,"data-test":"update-profile-button"},{default:r(()=>[...e[12]||(e[12]=[d("Save",-1)])]),_:1},8,["disabled"]),t(G,{"enter-active-class":"transition ease-in-out","enter-from-class":"opacity-0","leave-active-class":"transition ease-in-out","leave-to-class":"opacity-0"},{default:r(()=>[q(a("p",Ue," Saved. ",512),[[z,s(u).recentlySuccessful]])]),_:1})])],32)])]),t(ue)]),_:1})]),_:1}))}});export{Re as default};
