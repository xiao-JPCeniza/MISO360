import{d as K,r as Q,f as B,g as $,c as n,a as l,u,h as W,w as h,b as t,t as d,l as w,i as j,j as g,v as A,k as x,o,e as p,m as k,F as v,n as F,p as _,q as X,s as Y,x as S}from"./app-BKeQIzJd.js";import{_ as c}from"./Icon.vue_vue_type_script_setup_true_lang-DYjk_GmE.js";import{_ as Z}from"./AppLayout.vue_vue_type_script_setup_true_lang-D4ZJz0Dy.js";import"./upload-DSksIzvM.js";import"./trash-2-Cun_mNeM.js";import"./camera-bBREAO-E.js";import"./check-DJXCSFag.js";import"./image-CEZTpjPF.js";import"./sun-CVeL1nfb.js";import"./user-plus-COduW6wu.js";import"./lazy-CSzc0j1S.js";const ee={class:"flex flex-1 flex-col gap-6 p-4 sm:p-6"},te={class:"grid gap-4 sm:grid-cols-3"},re={class:"flex items-start gap-4 rounded-xl border border-sidebar-border/60 bg-card p-4 shadow-sm dark:border-white/10"},se={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-primary/10 text-primary"},oe={class:"min-w-0 flex-1"},de={class:"mt-1 text-2xl font-semibold tabular-nums text-foreground"},ae={class:"flex items-start gap-4 rounded-xl border border-sidebar-border/60 bg-card p-4 shadow-sm dark:border-white/10"},ne={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-primary/10 text-primary"},ie={class:"min-w-0 flex-1"},le={class:"mt-1 text-2xl font-semibold tabular-nums text-foreground"},ue={class:"flex items-start gap-4 rounded-xl border border-sidebar-border/60 bg-card p-4 shadow-sm dark:border-white/10"},ce={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-primary/10 text-primary"},me={class:"min-w-0 flex-1"},xe={class:"mt-1 text-2xl font-semibold tabular-nums text-foreground"},pe={class:"flex flex-col gap-3"},be={class:"grid gap-4 sm:grid-cols-2"},fe={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-primary/10 text-primary"},he={class:"min-w-0"},ge={class:"text-xs text-muted-foreground"},ve={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-primary/10 text-primary"},ye={class:"flex flex-col gap-3"},we={class:"rounded-xl border border-sidebar-border/60 bg-card p-3 shadow-sm dark:border-white/10"},ke={class:"min-w-[140px] flex-1"},_e={class:"flex shrink-0 gap-2"},Se={class:"overflow-hidden rounded-xl border border-sidebar-border/60 bg-card shadow-sm dark:border-white/10"},qe={class:"max-h-[420px] overflow-auto"},Te={class:"w-full min-w-[800px] text-xs"},Ce={class:"sticky top-0 z-10 border-b border-sidebar-border/60 bg-muted/50 text-[11px] uppercase tracking-wide text-muted-foreground dark:border-white/10 dark:bg-white/5"},De={class:"px-3 py-2.5 text-left font-semibold"},Ne={class:"px-3 py-2.5 text-left font-semibold"},Qe={class:"px-3 py-2.5 text-left font-semibold"},Ae={class:"divide-y divide-sidebar-border/60 text-foreground dark:divide-white/10"},Fe={class:"whitespace-nowrap px-3 py-2 text-muted-foreground"},Ue={class:"px-3 py-2 font-medium"},Re={key:1},Le=["title"],Me=["title"],Ve={class:"px-3 py-2"},Be={class:"px-3 py-2"},$e=["title"],je={key:0},Oe={key:0,class:"border-t border-sidebar-border/60 px-3 py-2 text-center dark:border-white/10"},Ie={class:"flex flex-col gap-3"},Pe={class:"flex flex-wrap items-center justify-between gap-2"},He={class:"flex flex-col gap-3 rounded-xl border border-sidebar-border/60 bg-card p-4 shadow-sm dark:border-white/10"},Ee={class:"min-w-[200px] flex-1"},Ge={class:"flex flex-wrap items-end gap-3 rounded-lg border border-sidebar-border/40 bg-muted/30 p-3 dark:border-white/10 dark:bg-white/5"},ze={class:"min-w-[180px]"},Je=["value"],Ke={class:"min-w-[120px]"},We={class:"min-w-[120px]"},Xe=["href"],Ye={class:"overflow-x-auto"},Ze={class:"w-full min-w-[720px] text-xs"},et={class:"divide-y divide-sidebar-border/60 text-foreground dark:divide-white/10"},tt={class:"px-3 py-2 font-medium"},rt={key:1},st=["title"],ot={class:"max-w-[120px] truncate px-3 py-2"},dt={class:"px-3 py-2"},at={class:"px-3 py-2"},nt={class:"whitespace-nowrap px-3 py-2 text-muted-foreground"},it={key:0},lt={key:0,class:"flex flex-wrap items-center justify-center gap-2 pt-2"},ut=["innerHTML","onClick"],ct=["innerHTML"],U="inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] font-medium leading-4",St=K({__name:"AdminDashboard",props:{totalGenerated:{},activeQueueTotal:{},stats:{},activeQueue:{},archive:{},filters:{},sort:{},archiveSearch:{},archivePanelOpen:{type:Boolean},staffOptions:{}},setup(a){const b=a,O=[{title:"Admin Dashboard",href:"/admin/dashboard"}],q=Q(b.archivePanelOpen??!1),f=B({control_ticket_number:b.filters.control_ticket_number??""}),y=B({archive_search:b.archiveSearch??""}),T=Q(""),C=Q(""),D=Q(""),I=$(()=>{const s=new URLSearchParams;y.archive_search&&s.set("archive_search",y.archive_search),T.value&&s.set("date_from",T.value),C.value&&s.set("date_to",C.value),D.value&&s.set("assigned_staff_id",D.value);const e=s.toString();return`/admin/dashboard/archive-export${e?`?${e}`:""}`}),P=$(()=>!!f.control_ticket_number);function N(s={}){const e={};return f.control_ticket_number&&(e.control_ticket_number=f.control_ticket_number),b.archiveSearch&&(e.archive_search=b.archiveSearch),{...e,...s}}function H(){S.get("/admin/dashboard",N(),{preserveState:!0,only:["activeQueue","activeQueueTotal","stats","filters","sort","archive","archiveSearch"]})}function E(){f.reset(),S.get("/admin/dashboard",N(),{preserveState:!0,only:["activeQueue","activeQueueTotal","stats","filters","sort","archive","archiveSearch"]})}function R(s){const e=b.sort.by===s&&b.sort.dir==="asc"?"desc":"asc";S.get("/admin/dashboard",N({sort_by:s,sort_dir:e}),{preserveState:!0,only:["activeQueue","activeQueueTotal","stats","filters","sort","archive","archiveSearch"]})}function G(){S.get("/admin/dashboard",N({archive_search:y.archive_search||void 0}),{preserveState:!0,only:["archive","archiveSearch"]})}function z(s){s&&S.visit(s)}const m={emerald:"border-emerald-500/30 bg-emerald-500/10 text-emerald-700 dark:text-emerald-300",blue:"border-blue-500/30 bg-blue-500/10 text-blue-700 dark:text-blue-300",amber:"border-amber-500/30 bg-amber-500/10 text-amber-700 dark:text-amber-300",rose:"border-rose-500/30 bg-rose-500/10 text-rose-700 dark:text-rose-300",slate:"border-slate-500/20 bg-slate-500/10 text-slate-600 dark:text-slate-300"};function L(s){const e=(s??"").toLowerCase();return e.includes("completed")||e.includes("closed")?m.emerald:e.includes("ongoing")||e.includes("assigned")?m.blue:e.includes("pending")||e.includes("review")?m.amber:m.slate}function M(s){const e=(s??"").toLowerCase();return e.includes("simple")?m.emerald:e.includes("average")||e.includes("moderate")?m.amber:e.includes("complex")||e.includes("urgent")?m.rose:m.slate}function V(s){if(!s)return"—";const e=new Date(s);return Number.isNaN(e.getTime())?s:new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",year:"numeric"}).format(e)}function i(s,e="—"){return s&&s.trim().length>0?s:e}return(s,e)=>(o(),n(v,null,[l(u(W),{title:"Admin Dashboard"}),l(Z,{breadcrumbs:O},{default:h(()=>[t("div",ee,[t("div",te,[t("div",re,[t("div",se,[l(c,{name:"clipboardList",class:"h-5 w-5"})]),t("div",oe,[e[9]||(e[9]=t("p",{class:"text-[11px] font-medium uppercase tracking-wider text-muted-foreground"}," Active in queue ",-1)),t("p",de,d(a.stats.activeInQueue),1),e[10]||(e[10]=t("p",{class:"mt-0.5 text-xs text-muted-foreground"}," Pending + Ongoing ",-1))])]),t("div",ae,[t("div",ne,[l(c,{name:"userCheck",class:"h-5 w-5"})]),t("div",ie,[e[11]||(e[11]=t("p",{class:"text-[11px] font-medium uppercase tracking-wider text-muted-foreground"}," Assigned to me ",-1)),t("p",le,d(a.stats.assignedToMe),1),e[12]||(e[12]=t("p",{class:"mt-0.5 text-xs text-muted-foreground"}," Requests assigned to you ",-1))])]),t("div",ue,[t("div",ce,[l(c,{name:"layers",class:"h-5 w-5"})]),t("div",me,[e[13]||(e[13]=t("p",{class:"text-[11px] font-medium uppercase tracking-wider text-muted-foreground"}," Total received ",-1)),t("p",xe,d(a.stats.totalReceived),1),e[14]||(e[14]=t("p",{class:"mt-0.5 text-xs text-muted-foreground"}," All requests received ",-1))])])]),t("div",pe,[e[17]||(e[17]=t("h2",{class:"text-sm font-semibold text-foreground"}," Quick actions ",-1)),t("div",be,[l(u(w),{href:"/admin/qr-generator",class:"flex items-center gap-3 rounded-xl border border-sidebar-border/60 bg-card p-4 shadow-sm dark:border-white/10"},{default:h(()=>[t("div",fe,[l(c,{name:"qrcode",class:"h-5 w-5"})]),t("div",he,[e[15]||(e[15]=t("p",{class:"text-sm font-medium text-foreground"}," QR Generator ",-1)),t("p",ge,d(a.totalGenerated)+" codes generated ",1)])]),_:1}),l(u(w),{href:"/admin/enrollments/create",class:"flex items-center gap-3 rounded-xl border border-sidebar-border/60 bg-card p-4 shadow-sm dark:border-white/10"},{default:h(()=>[t("div",ve,[l(c,{name:"clipboardList",class:"h-5 w-5"})]),e[16]||(e[16]=t("div",{class:"min-w-0"},[t("p",{class:"text-sm font-medium text-foreground"}," Enroll ticket "),t("p",{class:"text-xs text-muted-foreground"}," Add new enrollment ")],-1))]),_:1})])]),t("div",ye,[e[28]||(e[28]=t("h2",{class:"text-sm font-semibold text-foreground"}," Requests Queue ",-1)),e[29]||(e[29]=t("p",{class:"text-xs text-muted-foreground"}," Pending requests only (FIFO—oldest first). Requests with no status are not shown. Sort by date filed, control ticket, or requester; filter below. ",-1)),t("div",we,[t("form",{class:"flex flex-wrap items-end gap-3",onSubmit:j(H,["prevent"])},[t("div",ke,[e[18]||(e[18]=t("label",{class:"mb-1 block text-[11px] font-medium uppercase text-muted-foreground"}," Control ticket ",-1)),g(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>u(f).control_ticket_number=r),type:"text",class:"w-full rounded-md border border-sidebar-border/60 bg-background px-2.5 py-1.5 text-xs text-foreground dark:border-white/10",placeholder:"e.g. CTRL-001"},null,512),[[A,u(f).control_ticket_number]])]),t("div",_e,[e[19]||(e[19]=t("button",{type:"submit",class:"rounded-md bg-primary px-3 py-1.5 text-xs font-medium text-primary-foreground hover:opacity-90"}," Apply ",-1)),P.value?(o(),n("button",{key:0,type:"button",class:"rounded-md border border-sidebar-border/60 px-3 py-1.5 text-xs font-medium text-foreground dark:border-white/10",onClick:E}," Clear ")):x("",!0)])],32)]),t("div",Se,[t("div",qe,[t("table",Te,[t("thead",Ce,[t("tr",null,[t("th",De,[t("button",{type:"button",class:"flex items-center gap-1 hover:text-foreground",onClick:e[1]||(e[1]=r=>R("created_at"))},[e[20]||(e[20]=p(" Date filed ",-1)),a.sort.by==="created_at"?(o(),k(c,{key:0,name:a.sort.dir==="asc"?"chevronUp":"chevronDown",class:"h-3.5 w-3.5"},null,8,["name"])):x("",!0)])]),t("th",Ne,[t("button",{type:"button",class:"flex items-center gap-1 hover:text-foreground",onClick:e[2]||(e[2]=r=>R("control_ticket_number"))},[e[21]||(e[21]=p(" Control ticket ",-1)),a.sort.by==="control_ticket_number"?(o(),k(c,{key:0,name:a.sort.dir==="asc"?"chevronUp":"chevronDown",class:"h-3.5 w-3.5"},null,8,["name"])):x("",!0)])]),t("th",Qe,[t("button",{type:"button",class:"flex items-center gap-1 hover:text-foreground",onClick:e[3]||(e[3]=r=>R("requester_name"))},[e[22]||(e[22]=p(" Requester ",-1)),a.sort.by==="requester_name"?(o(),k(c,{key:0,name:a.sort.dir==="asc"?"chevronUp":"chevronDown",class:"h-3.5 w-3.5"},null,8,["name"])):x("",!0)])]),e[23]||(e[23]=t("th",{class:"px-3 py-2.5 text-left font-semibold"}," Office ",-1)),e[24]||(e[24]=t("th",{class:"px-3 py-2.5 text-left font-semibold"}," Category ",-1)),e[25]||(e[25]=t("th",{class:"px-3 py-2.5 text-left font-semibold"}," Status ",-1)),e[26]||(e[26]=t("th",{class:"max-w-[160px] px-3 py-2.5 text-left font-semibold"}," Remarks ",-1))])]),t("tbody",Ae,[(o(!0),n(v,null,F(a.activeQueue,r=>(o(),n("tr",{key:r.id,class:"hover:bg-muted/30 dark:hover:bg-white/5"},[t("td",Fe,d(V(r.dateFiled)),1),t("td",Ue,[r.showUrl?(o(),k(u(w),{key:0,href:r.showUrl,class:"text-primary hover:underline"},{default:h(()=>[p(d(r.controlTicketNumber),1)]),_:2},1032,["href"])):(o(),n("span",Re,d(r.controlTicketNumber),1))]),t("td",{class:"max-w-[140px] truncate px-3 py-2",title:i(r.requesterName)},d(i(r.requesterName)),9,Le),t("td",{class:"max-w-[120px] truncate px-3 py-2",title:i(r.office)},d(i(r.office)),9,Me),t("td",Ve,[t("span",{class:_([U,M(r.category)])},d(i(r.category,"—")),3)]),t("td",Be,[t("span",{class:_([U,L(r.status)])},d(i(r.status,"—")),3)]),t("td",{class:"max-w-[160px] truncate px-3 py-2 text-muted-foreground",title:i(r.remarks)},d(i(r.remarks,"—")),9,$e)]))),128)),a.activeQueue.length===0?(o(),n("tr",je,[...e[27]||(e[27]=[t("td",{colspan:"8",class:"px-4 py-8 text-center text-xs text-muted-foreground"}," No pending requests in the queue. ",-1)])])):x("",!0)])])]),a.activeQueueTotal>15?(o(),n("div",Oe,[l(u(w),{href:"/requests",class:"text-xs font-medium text-primary hover:underline"},{default:h(()=>[p(" View all "+d(a.activeQueueTotal)+" active requests → ",1)]),_:1})])):x("",!0)])]),t("div",Ie,[t("div",Pe,[t("button",{type:"button",class:"flex items-center gap-2 text-sm font-semibold text-foreground hover:underline",onClick:e[4]||(e[4]=r=>q.value=!q.value)},[l(c,{name:q.value?"chevronDown":"chevronRight",class:"h-4 w-4"},null,8,["name"]),e[30]||(e[30]=p(" Archived Requests ",-1))])]),g(t("div",He,[t("form",{class:"flex flex-wrap items-end gap-3",onSubmit:j(G,["prevent"])},[t("div",Ee,[e[31]||(e[31]=t("label",{class:"mb-1 block text-[11px] font-medium uppercase text-muted-foreground"}," Search archive ",-1)),g(t("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>u(y).archive_search=r),type:"text",class:"w-full rounded-md border border-sidebar-border/60 bg-background px-2.5 py-1.5 text-xs text-foreground dark:border-white/10",placeholder:"Control ticket or requester name"},null,512),[[A,u(y).archive_search]])]),e[32]||(e[32]=t("button",{type:"submit",class:"rounded-md bg-primary px-3 py-1.5 text-xs font-medium text-primary-foreground hover:opacity-90"}," Search ",-1))],32),t("div",Ge,[e[38]||(e[38]=t("p",{class:"w-full text-[11px] font-medium uppercase text-muted-foreground"}," Download report ",-1)),t("div",ze,[e[34]||(e[34]=t("label",{class:"mb-1 block text-[11px] font-medium uppercase text-muted-foreground"}," MIS staff (optional) ",-1)),g(t("select",{"onUpdate:modelValue":e[6]||(e[6]=r=>D.value=r),class:"w-full rounded-md border border-sidebar-border/60 bg-background px-2.5 py-1.5 text-xs text-foreground dark:border-white/10"},[e[33]||(e[33]=t("option",{value:""},"All staff",-1)),(o(!0),n(v,null,F(a.staffOptions,r=>(o(),n("option",{key:r.id,value:String(r.id)},d(r.name),9,Je))),128))],512),[[X,D.value]])]),t("div",Ke,[e[35]||(e[35]=t("label",{class:"mb-1 block text-[11px] font-medium uppercase text-muted-foreground"}," Date from ",-1)),g(t("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>T.value=r),type:"date",class:"w-full rounded-md border border-sidebar-border/60 bg-background px-2.5 py-1.5 text-xs text-foreground dark:border-white/10"},null,512),[[A,T.value]])]),t("div",We,[e[36]||(e[36]=t("label",{class:"mb-1 block text-[11px] font-medium uppercase text-muted-foreground"}," Date to ",-1)),g(t("input",{"onUpdate:modelValue":e[8]||(e[8]=r=>C.value=r),type:"date",class:"w-full rounded-md border border-sidebar-border/60 bg-background px-2.5 py-1.5 text-xs text-foreground dark:border-white/10"},null,512),[[A,C.value]])]),t("a",{href:I.value,class:"inline-flex items-center gap-2 rounded-md border border-sidebar-border/60 bg-card px-3 py-1.5 text-xs font-medium text-foreground hover:bg-muted/50 dark:border-white/10"},[l(c,{name:"download",class:"h-4 w-4"}),e[37]||(e[37]=p(" Download Report ",-1))],8,Xe),e[39]||(e[39]=t("p",{class:"w-full text-[11px] text-muted-foreground"}," Exports completed requests. Filter by Management Information System staff, optional date range (max 365 days). Current search filter is applied. ",-1))]),t("div",Ye,[t("table",Ze,[e[41]||(e[41]=t("thead",{class:"border-b border-sidebar-border/60 bg-muted/50 text-[11px] uppercase tracking-wide text-muted-foreground dark:border-white/10 dark:bg-white/5"},[t("tr",null,[t("th",{class:"px-3 py-2.5 text-left font-semibold"}," Control ticket "),t("th",{class:"px-3 py-2.5 text-left font-semibold"}," Requester "),t("th",{class:"px-3 py-2.5 text-left font-semibold"}," Office "),t("th",{class:"px-3 py-2.5 text-left font-semibold"}," Category "),t("th",{class:"px-3 py-2.5 text-left font-semibold"}," Status "),t("th",{class:"px-3 py-2.5 text-left font-semibold"}," Date filed ")])],-1)),t("tbody",et,[(o(!0),n(v,null,F(a.archive.data,r=>(o(),n("tr",{key:r.id,class:"hover:bg-muted/30 dark:hover:bg-white/5"},[t("td",tt,[r.showUrl?(o(),k(u(w),{key:0,href:r.showUrl,class:"text-primary hover:underline"},{default:h(()=>[p(d(r.controlTicketNumber),1)]),_:2},1032,["href"])):(o(),n("span",rt,d(r.controlTicketNumber),1))]),t("td",{class:"max-w-[140px] truncate px-3 py-2",title:i(r.requesterName)},d(i(r.requesterName)),9,st),t("td",ot,d(i(r.office)),1),t("td",dt,[t("span",{class:_([U,M(r.category)])},d(i(r.category,"—")),3)]),t("td",at,[t("span",{class:_([U,L(r.status)])},d(i(r.status,"—")),3)]),t("td",nt,d(V(r.dateFiled)),1)]))),128)),a.archive.data.length===0?(o(),n("tr",it,[...e[40]||(e[40]=[t("td",{colspan:"6",class:"px-4 py-8 text-center text-xs text-muted-foreground"}," No archived requests. ",-1)])])):x("",!0)])])]),a.archive.last_page>1?(o(),n("div",lt,[(o(!0),n(v,null,F(a.archive.links,(r,J)=>(o(),n(v,{key:J},[r.url?(o(),n("button",{key:0,type:"button",class:_(["rounded border border-sidebar-border/60 px-2 py-1 text-xs text-foreground hover:bg-muted/50 dark:border-white/10",{"bg-primary text-primary-foreground":r.active}]),innerHTML:r.label,onClick:mt=>z(r.url)},null,10,ut)):(o(),n("span",{key:1,class:"px-2 py-1 text-xs text-muted-foreground",innerHTML:r.label},null,8,ct))],64))),128))])):x("",!0)],512),[[Y,q.value]])])])]),_:1})],64))}});export{St as default};
