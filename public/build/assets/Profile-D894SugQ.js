import{d as w,m as S,e as t,O,w as r,P as E,o as m,a as _,b as s,f as a,k as d,Q as L,C as B,c as f,u as F,s as P,h as I,j as R,t as V,g as M,T as N,i as G,q}from"./app-DjKwfWyu.js";import{_ as b}from"./HeadingSmall.vue_vue_type_script_setup_true_lang-6e3qusa3.js";import{D as W,a as p,j as z,u as J,X,_ as Y}from"./AppLayout.vue_vue_type_script_setup_true_lang-CGMNLiAn.js";import{a as Q,b as Z,c as H,d as K,_ as ee}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CnPfr2kM.js";import{_ as te}from"./DialogClose.vue_vue_type_script_setup_true_lang-DE4z-d5w.js";import{_ as se}from"./DialogFooter.vue_vue_type_script_setup_true_lang-JqOivcN2.js";import{b as x,_ as $,a as C}from"./Label.vue_vue_type_script_setup_true_lang-CZsl-4h0.js";import{_ as ae}from"./Layout.vue_vue_type_script_setup_true_lang-Bs6kMBHZ.js";import{C as re}from"./camera-DEURr7sx.js";import{C as le}from"./check-CatmDcjo.js";import"./index-CSzc0j1S.js";const ie=w({__name:"DialogTrigger",props:{asChild:{type:Boolean},as:{}},setup(h){const v=h;return(l,o)=>(m(),S(t(W),O({"data-slot":"dialog-trigger"},v),{default:r(()=>[E(l.$slots,"default")]),_:3},16))}}),oe={class:"space-y-6"},ne={class:"space-y-4 rounded-lg border border-red-100 bg-red-50 p-4 dark:border-red-200/10 dark:bg-red-700/10"},de=w({__name:"DeleteUser",setup(h){return(v,l)=>(m(),_("div",oe,[s(b,{title:"Delete account",description:"Delete your account and all of its resources"}),a("div",ne,[l[5]||(l[5]=a("div",{class:"relative space-y-0.5 text-red-600 dark:text-red-100"},[a("p",{class:"font-medium"},"Warning"),a("p",{class:"text-sm"}," Please proceed with caution, this cannot be undone. ")],-1)),s(t(ee),null,{default:r(()=>[s(t(ie),{"as-child":""},{default:r(()=>[s(t(p),{variant:"destructive","data-test":"delete-user-button"},{default:r(()=>[...l[0]||(l[0]=[d("Delete account",-1)])]),_:1})]),_:1}),s(t(Q),null,{default:r(()=>[s(t(L),{action:"/settings/profile",method:"delete","reset-on-success":"",options:{preserveScroll:!0},class:"space-y-6"},{default:r(({processing:o,reset:g,clearErrors:u})=>[s(t(Z),{class:"space-y-3"},{default:r(()=>[s(t(H),null,{default:r(()=>[...l[1]||(l[1]=[d("Are you sure you want to delete your account?",-1)])]),_:1}),s(t(K),null,{default:r(()=>[...l[2]||(l[2]=[d(" Once your account is deleted, all of its resources and data will also be permanently deleted. Please confirm you would like to permanently delete your account. ",-1)])]),_:1})]),_:1}),s(t(se),{class:"gap-2"},{default:r(()=>[s(t(te),{"as-child":""},{default:r(()=>[s(t(p),{variant:"secondary",onClick:()=>{u(),g()}},{default:r(()=>[...l[3]||(l[3]=[d(" Cancel ",-1)])]),_:1},8,["onClick"])]),_:2},1024),s(t(p),{type:"submit",variant:"destructive",disabled:o,"data-test":"confirm-delete-user-button"},{default:r(()=>[...l[4]||(l[4]=[d(" Delete account ",-1)])]),_:1},8,["disabled"])]),_:2},1024)]),_:1})]),_:1})]),_:1})])]))}}),ue={class:"flex flex-col space-y-8"},ce={class:"relative z-10 flex flex-col space-y-6 isolate","aria-label":"Profile picture section"},fe=["data-current-avatar","data-csrf-token","data-initials"],pe={class:"group relative flex shrink-0 select-none rounded-full"},me={class:"relative flex h-36 w-36 cursor-pointer items-center justify-center overflow-hidden rounded-full border-4 border-white shadow-lg transition focus-visible:ring-2 focus-visible:ring-[#2563eb] focus-visible:ring-offset-2 focus-visible:ring-offset-background dark:border-slate-800/80 dark:focus-visible:ring-[#93c5fd] dark:focus-visible:ring-offset-[#0b1b3a] sm:h-40 sm:w-40","x-on:click.prevent":"choose","x-on:drop":"onDrop","x-on:dragover":"onDragOver","x-on:dragleave":"onDragLeave","x-bind:class":"dragOver ? 'ring-4 ring-[#2563eb]/60 ring-offset-2 ring-offset-background dark:ring-[#93c5fd]/60 dark:ring-offset-[#0b1b3a]' : ''"},ve=["alt"],ge={class:"absolute inset-0 flex flex-col items-center justify-center rounded-full bg-black/50 opacity-0 transition-opacity duration-200 group-hover:opacity-100 group-focus-within:opacity-100","aria-hidden":"true"},he={"x-show":"file",class:"flex flex-wrap items-center gap-2","x-cloak":""},xe={key:0,class:"text-sm font-medium text-emerald-600 dark:text-emerald-400",role:"status"},_e={class:"flex flex-col space-y-6"},be={class:"grid gap-2"},we={class:"grid gap-2"},ke={class:"flex items-center gap-4"},ye={class:"text-sm text-neutral-600"},D="image/jpeg,image/jpg,image/png,image/webp",Ue=50*1024*1024,Pe="profile-avatar-input",Fe=w({__name:"Profile",props:{status:{},errors:{default:()=>({})},auth:{}},setup(h){const v=[{title:"Profile settings",href:z().url}],l=B(),o=f(()=>l.props.auth?.user),{getInitials:g}=J(),u=F({name:o.value?.name||""}),T=D.split(",").map(n=>n.trim()),k=f(()=>o.value?.avatar_url??(o.value?.avatar&&o.value.avatar!==""?o.value.avatar:null)),A=f(()=>l.props.csrf_token??""),y=f(()=>l.props.status),j=f(()=>l.props.errors?.avatar);return f(()=>o.value?g(o.value.name):"?"),window.profileAvatarUploader=n=>{const e=n.currentAvatar;return{file:null,previewUrl:n.currentAvatar,error:"",success:"",uploading:!1,progress:0,dragOver:!1,initials:n.initials||"?",cameraLabel(){return this.file?"Choose different photo":"Change Photo"},choose(){this.$refs.fileInput?.click()},onDragOver(i){i.preventDefault(),this.dragOver=!0},onDragLeave(){this.dragOver=!1},onDrop(i){i.preventDefault(),this.dragOver=!1;const c=i.dataTransfer?.files?.[0];c&&this.setFile(c)},onChange(i){const c=i.target,U=c.files?.[0];U&&this.setFile(U),c.value=""},clearMessages(){this.error="",this.success=""},clearSelection(){this.previewUrl&&this.previewUrl!==e&&URL.revokeObjectURL(this.previewUrl),this.previewUrl=e,this.file=null,this.progress=0,this.clearMessages()},setFile(i){if(this.clearMessages(),!T.includes(i.type)){this.error="Please choose a JPG, PNG, or WEBP image.";return}if(i.size>Ue){this.error="Image must be under 50 MB.";return}this.previewUrl&&this.previewUrl!==e&&URL.revokeObjectURL(this.previewUrl),this.previewUrl=URL.createObjectURL(i),this.file=i},save(){if(!this.file){this.error="Please choose a photo first.";return}if(!n.csrfToken){this.error="Session expired. Please refresh and try again.";return}this.uploading=!0,this.error="",this.success="",this.progress=0;const i=new FormData;i.append("_token",n.csrfToken),i.append("avatar",this.file),P.post(n.uploadUrl,i,{forceFormData:!0,preserveState:!1,onProgress:c=>{this.progress=c?.percent??0},onSuccess:()=>{this.success="Profile photo updated.",this.file=null,this.progress=100,this.previewUrl&&this.previewUrl!==e&&URL.revokeObjectURL(this.previewUrl),this.previewUrl=e},onError:c=>{this.error=c?.avatar||"Failed to update photo."},onFinish:()=>{this.uploading=!1,this.error||P.reload({preserveState:!1})}})}}},(n,e)=>(m(),S(Y,{breadcrumbs:v},{default:r(()=>[s(t(I),{title:"Profile settings"}),e[13]||(e[13]=a("h1",{class:"sr-only"},"Profile Settings",-1)),s(ae,null,{default:r(()=>[a("div",ue,[a("section",ce,[s(b,{title:"Profile picture",description:"Click your photo to change it. JPG, PNG or WEBP, up to 50 MB. Shown across the app."}),(m(),_("div",{key:(k.value??"")+"_"+(o.value?.id??""),"x-data":`profileAvatarUploader({
                            currentAvatar: $el.dataset.currentAvatar || null,
                            csrfToken: $el.dataset.csrfToken || '',
                            uploadUrl: $el.dataset.uploadUrl || '/settings/profile/avatar',
                            initials: $el.dataset.initials || '?',
                        })`,"data-current-avatar":k.value??"","data-csrf-token":A.value,"data-upload-url":"/settings/profile/avatar","data-initials":o.value?t(g)(o.value.name):"?",class:"flex flex-col items-center gap-6 sm:items-start"},[a("input",{id:Pe,"x-ref":"fileInput",type:"file",accept:D,class:"sr-only","aria-label":"Choose profile photo","x-on:change":"onChange"}),a("div",pe,[a("div",me,[e[3]||(e[3]=a("span",{class:"sr-only"},"Change profile picture",-1)),a("img",{"x-show":"previewUrl","x-bind:src":"previewUrl",alt:o.value?.name??"Profile",class:"h-full w-full object-contain object-center"},null,8,ve),e[4]||(e[4]=a("div",{"x-show":"!previewUrl",class:"flex h-full w-full items-center justify-center bg-slate-200 text-4xl font-semibold text-slate-600 dark:bg-slate-700 dark:text-slate-300 sm:text-5xl"},[a("span",{"x-text":"initials"})],-1)),a("span",ge,[s(t(re),{class:"h-10 w-10 text-white sm:h-12 sm:w-12"}),e[2]||(e[2]=a("span",{class:"mt-1.5 text-sm font-medium text-white","x-text":"cameraLabel()"},null,-1))])])]),a("div",he,[s(t(p),{type:"button",disabled:n.uploading,"data-test":"save-avatar-button",class:"gap-2","x-on:click":"save"},{default:r(()=>[s(t(le),{class:"h-4 w-4","aria-hidden":"true"}),e[5]||(e[5]=a("span",{"x-text":"uploading ? 'Saving…' : 'Save'"},null,-1))]),_:1},8,["disabled"]),s(t(p),{type:"button",variant:"outline",disabled:n.uploading,class:"gap-2","x-on:click":"clearSelection"},{default:r(()=>[s(t(X),{class:"h-4 w-4","aria-hidden":"true"}),e[6]||(e[6]=d(" Cancel ",-1))]),_:1},8,["disabled"]),e[7]||(e[7]=a("div",{"x-show":"uploading",class:"text-sm text-muted-foreground","x-cloak":""},[d(" Uploading… "),a("span",{"x-text":"`${Math.round(progress ?? 0)}%`"})],-1))]),y.value?(m(),_("p",xe,V(y.value),1)):R("",!0),e[8]||(e[8]=a("p",{"x-show":"success",class:"text-sm font-medium text-emerald-600 dark:text-emerald-400","x-text":"success",role:"status","x-cloak":""},null,-1)),e[9]||(e[9]=a("p",{"x-show":"error",class:"text-sm font-medium text-rose-600 dark:text-rose-400","x-text":"error",role:"status","x-cloak":""},null,-1)),s(x,{message:j.value,class:"text-center sm:text-left"},null,8,["message"])],8,fe))]),a("section",_e,[s(b,{title:"Profile information",description:"Update your name and email address"}),a("form",{onSubmit:e[1]||(e[1]=M(i=>t(u).patch("/settings/profile"),["prevent"])),class:"space-y-6"},[a("div",be,[s(t($),{for:"name"},{default:r(()=>[...e[10]||(e[10]=[d("Name",-1)])]),_:1}),s(t(C),{id:"name",class:"mt-1 block w-full",modelValue:t(u).name,"onUpdate:modelValue":e[0]||(e[0]=i=>t(u).name=i),name:"name",required:"",autocomplete:"name",placeholder:"Full name"},null,8,["modelValue"]),s(x,{class:"mt-2",message:t(u).errors.name},null,8,["message"])]),a("div",we,[s(t($),{for:"email"},{default:r(()=>[...e[11]||(e[11]=[d("Email address",-1)])]),_:1}),s(t(C),{id:"email",type:"email",class:"mt-1 block w-full",name:"email","default-value":o.value?.email,required:"",autocomplete:"username",placeholder:"Email address",disabled:""},null,8,["default-value"]),s(x,{class:"mt-2",message:t(u).errors.email},null,8,["message"])]),a("div",ke,[s(t(p),{type:"submit",disabled:t(u).processing,"data-test":"update-profile-button"},{default:r(()=>[...e[12]||(e[12]=[d("Save",-1)])]),_:1},8,["disabled"]),s(N,{"enter-active-class":"transition ease-in-out","enter-from-class":"opacity-0","leave-active-class":"transition ease-in-out","leave-to-class":"opacity-0"},{default:r(()=>[G(a("p",ye," Saved. ",512),[[q,t(u).recentlySuccessful]])]),_:1})])],32)])]),s(de)]),_:1})]),_:1}))}});export{Fe as default};
